(window.webpackJsonp = window.webpackJsonp || []).push([[9], { 668: function(t, e, n) {}, 682: function(t, e, n) { 'use strict'; n(668) }, 683: function(t, e, n) { 'use strict'; n(19), n(12), n(13), n(26), n(27); var o = n(3); var r = (n(11), n(157)); var dialog = (n(364), n(156)); var c = n.n(dialog); var l = (n(47), n(664)); var m = n(663); var d = n(669); var h = (n(687), n(70), n(48), n(81), n(55), n(28), n(122), n(688), n(0)); var f = n(689); var v = n.n(f); var _ = n(690); var w = n.n(_); h.default.use(v.a); var y = { name: 'EmailDropdown', inheritAttrs: !1, props: { initialValue: { type: String, default: '' }, domains: { type: Array, required: !0 }, defaultDomains: { type: Array, default: function() { return [] } }, maxSuggestions: { type: Number, default: 4, validator: function(t) { var e = Number.isInteger(t); if (!e) throw new Error('Invalid prop: type check failed for prop "maxSuggestions". Expected Integer but got '.concat(t, ' as value.')); return e } }, closeOnClickOutside: { type: Boolean, default: !0 }, inputClasses: { type: [String, Array, Object], default: '' }}, data: function() { return { email: this.initialValue, isEscPressed: !1, listFocusIndex: 0, isFirstFocus: !1, hasclickedOutside: !1, clickOutsideConfig: { handler: this.clickOutsideHandler, middleware: this.middleware, events: ['dblclick', 'click'], isActive: !0 }} }, computed: { shouldShowList: function() { return Boolean(this.domainsList.length && !this.isOptionSelected && !this.isEscPressed) }, includesAt: function() { return this.email.toLowerCase().includes('@') }, username: function() { return this.email.toLowerCase().split('@')[0] }, emailDropdownContainerClasses: function() { return { 'email-dropdown-list-container': !0, hide: this.hasclickedOutside } }, domain: function() { return this.email.toLowerCase().split('@')[1] || '' }, suggestionList: function() { var t = this; return this.domainsList.map(function(e) { return ''.concat(t.username, '@').concat(e).toLowerCase() }) }, isOptionSelected: function() { return this.suggestionList.includes(this.email.toLowerCase()) }, domainsList: function() { var t = this; return this.includesAt ? !this.domain.length && this.defaultDomains.length ? this.defaultDomains.slice(0, this.maxSuggestions) : this.domain ? this.domains.filter(function(e) { return e.startsWith(t.domain) }).sort(function(a, b) { return a.toLowerCase().localeCompare(b.toLowerCase()) }).slice(0, this.maxSuggestions) : [] : [] } }, watch: { email: function() { this.$emit('input', this.email), this.resetFocusIndex(), this.isEscPressed && (this.isEscPressed = !1) } }, methods: { convertCharToText: function(t) { var e = w.a.fromEvent(t); if (e && !Object.values({ ENTER: 13, UP: 38, DOWN: 40 }).includes(e.charCode)) { var n = w.a.eventToCharacter(t); n && (this.email += n, this.$refs.email.focus()) } }, clickOutsideHandler: function() { this.hasclickedOutside = !0 }, handleInputEvent: function(t) { var e = t.target.value; this.email = e }, handleOptionSelection: function(t) { this.email = ''.concat(this.username, '@').concat(t), this.$refs.email.focus(), this.listFocusIndex = 0 }, middleware: function(t) { var e = t.target; var n = e.className === 'email-dropdown-item' && e.parentNode.className.includes('email-dropdown-list'); return this.closeOnClickOutside && !n }, handleEscPress: function() { this.isEscPressed = !0, this.$refs.email.focus() }, handleEmailInputFocus: function() { this.hasclickedOutside = !1, this.resetFocusIndex() }, resetFocusIndex: function() { this.isFirstFocus = !1, this.listFocusIndex = 0 }, handleListNavigation: function(t) { var e = this; if (this.shouldShowList && !this.shouldFocusInput(t)) { var n = t == 'up' && this.listFocusIndex >= 1; var o = t == 'down' && this.listFocusIndex < this.domainsList.length - 1; this.isFirstFocus ? n ? this.listFocusIndex -= 1 : o && (this.listFocusIndex += 1) : this.isFirstFocus = !0, this.$nextTick(function() { document.querySelector('[data-dropdown-item-index="'.concat(e.listFocusIndex, '"]')).focus() }) } }, shouldFocusInput: function(t) { var e = t === 'up' && this.listFocusIndex == 0; return e && (this.$refs.email.focus(), this.resetFocusIndex()), e } }}; var C = (n(682), n(6)); var component = Object(C.a)(y, function() { var t = this; var e = t.$createElement; var n = t._self._c || e; return n('div', { directives: [{ name: 'click-outside', rawName: 'v-click-outside', value: t.clickOutsideConfig, expression: 'clickOutsideConfig' }], staticClass: 'email-dropdown-wrapper' }, [n('div', { staticClass: 'input-button-wrapper' }, [n('input', t._g(t._b({ ref: 'email', class: t.inputClasses, attrs: { type: 'email', placeholder: '您的邮箱', autocorrect: 'off', autocomplete: 'off', autocapitalize: 'off' }, domProps: { value: t.email }, on: { focus: t.handleEmailInputFocus, input: t.handleInputEvent, keyup: [function(e) { return !e.type.indexOf('key') && t._k(e.keyCode, 'up', 38, e.key, ['Up', 'ArrowUp']) ? null : t.handleListNavigation('up') }, function(e) { return !e.type.indexOf('key') && t._k(e.keyCode, 'down', 40, e.key, ['Down', 'ArrowDown']) ? null : t.handleListNavigation('down') }, function(e) { return !e.type.indexOf('key') && t._k(e.keyCode, 'esc', 27, e.key, ['Esc', 'Escape']) ? null : t.handleEscPress.apply(null, arguments) }] }}, 'input', t.$attrs, !1), t.$listeners))]), t._v(' '), n('div', { class: t.emailDropdownContainerClasses }, [t.shouldShowList ? n('ul', { staticClass: 'email-dropdown-list white shadow-6' }, t._l(t.domainsList, function(e, o) { return n('li', { key: o, staticClass: 'email-dropdown-item', attrs: { tabindex: '-1', 'data-dropdown-item-index': o }, on: { click: function(n) { return t.handleOptionSelection(e) }, keyup: [function(e) { return !e.type.indexOf('key') && t._k(e.keyCode, 'esc', 27, e.key, ['Esc', 'Escape']) ? null : t.handleEscPress.apply(null, arguments) }, function(n) { return !n.type.indexOf('key') && t._k(n.keyCode, 'enter', 13, n.key, 'Enter') ? null : t.handleOptionSelection(e) }, function(e) { return !e.type.indexOf('key') && t._k(e.keyCode, 'up', 38, e.key, ['Up', 'ArrowUp']) ? null : t.handleListNavigation('up') }, function(e) { return !e.type.indexOf('key') && t._k(e.keyCode, 'down', 40, e.key, ['Down', 'ArrowDown']) ? null : t.handleListNavigation('down') }, t.convertCharToText] }}, [n('span', { staticClass: 'email-dropdown-item-username' }, [t._v(t._s(t.username))]), t._v(' '), n('span', { staticClass: 'email-dropdown-item-domain' }, [t._v('@' + t._s(e))])]) }), 0) : t._e()])]) }, [], !1, null, '371011c2', null); var k = component.exports; var x = { name: 'commandChat', props: { type: { type: String }, id: { type: Number }, post: { type: Object }, commentable: { type: Boolean, default: !1 }}, data: function() { return { isNewDate: +new Date(), chatList: [], chatPage: 1, chatNeedMail: !1, chatLoginDialog: !1, commentLoading: !1, comment_total: 0, comment_pagesize: 10, comment_currentPage: 1, comment: { name: '', email: '', content: '', loading: !1, nocomment: !1 }, clickOutside: !1, domains: ['126.com', '139.com', '163.com', 'aol.com', 'buston.cn', 'foxmail.com', 'gmail.com', 'gmx.de', 'googlemail.com', 'hensao.com', 'hggame.com', 'hotmail.co.uk', 'hotmail.com', 'hotmail.fr', 'hotmail.it', 'kcidc.com', 'live.com', 'love11.com', 'mail.ru', 'msn.com', 'oneplus.cn', 'oneplus.net', 'outlook.com', 'pay55.com', 'qq.com', 'rediffmail.com', 'sfba.cn', 'sina.com', 'sohu.com', 'tour0.com', 'vip.qq.com', 'web.de', 'yahoo.co.in', 'yahoo.co.uk', 'yahoo.com', 'yahoo.in', 'yeah.net', 'ymail.com', 'ytgame.com'], defaultDomains: ['qq.com', 'vip.qq.com', '163.com', '126.com', '139.com', 'gmail.com', 'sina.com', 'live.com', 'hotmail.com', 'msn.com', 'outlook.com', 'yahoo.com'] } }, components: Object(o.a)({ InfiniteLoading: l.a, VueEmoji: d.a, Avataaars: m.a, EmailDropdown: k }, c.a.Component.name, c.a.Component), watch: { id: function(t) { this.chatList = [], this.chatPage = 1, this.isNewDate = +new Date() } }, mounted: function() {}, methods: { insertText: function(t, e) { if (document.selection)document.selection.createRange().text = e; else if (typeof t.selectionStart === 'number' && typeof t.selectionEnd === 'number') { var n = t.selectionStart; var o = t.selectionEnd; var r = n; var c = t.value; t.value = c.substring(0, n) + e + c.substring(o, c.length), r += e.length, t.selectionStart = t.selectionEnd = r } else t.value += e; this.comment.content = t.value }, onSelectedChat: function(t) { this.insertText(this.$refs.chats, t) }, addChatNameEmail: function() { this.comment.name.length < 2 ? this.$toasted.show('昵称不能少于2个字', { themes: 'bubble', position: 'bottom-right', duration: 1500 }) : this.checkEmail(this.comment.email) === 1 ? this.$toasted.show('邮箱格式错误', { themes: 'bubble', position: 'bottom-right', duration: 1500 }) : (this.$storage.setUniversal('comment_user', this.comment.name), this.$storage.setUniversal('comment_email', this.comment.email), this.chatNeedMail = !1) }, addChat: function() { var t = this; var e = this.$storage.syncUniversal('comment_user'); var n = this.$storage.syncUniversal('comment_email'); if (!e || !n) return this.chatNeedMail = !0, !1; if (this.comment.content.length < 2) return this.$toasted.show('评论内容不能少于2个字', { themes: 'bubble', position: 'bottom-right', duration: 1500 }), !1; var o; var r = { status: 'draft', ip: this.ip.ip, address: this.getIpAddressString(), browser: this.getBrowserInfo(), os: this.getOSInfo(), useragent: navigator.userAgent, name: e, email: n, content: this.comment.content, avatar: 'macwk.com', ip_json: this.ip }; this.type === 'soft' && (r.soft = this.id, r.soft_version = this.post.version ? this.post.version : '', o = 'soft_comment'), this.type === 'article' && (r.article = this.id, o = 'article_comment'), this.comment.loading = !0; this.getFfToken(); this.$client.createItem(o, r).then(function(e) { e.public && (t.comment.content = '', t.comment.loading = !1, r.created_on = t.add8Hours(), t.chatList.push(r), t.$toasted.show('提交成功，等待管理员审核！', { themes: 'outline', position: 'bottom-right', duration: 2e3 }), t.comment.nocomment = !0) }) }, infiniteHandler: function(t) { var e; var filter; var n; var o; var c = this; this.type === 'soft' && (o = '-stick,-created_on', filter = { 'soft.id': { eq: this.id }}, n = 'id,created_on,address,avatar,browser,soft_version,useragent,content,name,os,soft,parent.id,parent.content,parent.name,stick', e = 'soft_comment'), this.type === 'article' && (o = '-created_on', filter = { 'article.id': { eq: this.id }}, n = 'id,created_on,address,avatar,browser,useragent,content,name,os,article,parent.id,parent.content,parent.name', e = 'article_comment'), setTimeout(function() { c.$client.getItems(e, { sort: o, filter: filter, offset: c.chatPage * c.comment_pagesize - c.comment_pagesize, limit: c.comment_pagesize, meta: 'filter_count', fields: n, status: 'published' }).then(function(e) { var n; e.data.length ? (c.chatPage += 1, (n = c.chatList).unshift.apply(n, Object(r.a)(e.data.reverse())), t.loaded()) : t.complete() }) }, 400) } }}; var O = x; var S = Object(C.a)(O, function() { var t = this; var e = t.$createElement; var n = t._self._c || e; return n('div', { staticClass: 'h-full w-full' }, [n('div', { staticClass: 'chat-body p-4' }, [n('infinite-loading', { attrs: { direction: 'top', identifier: t.isNewDate }, on: { infinite: t.infiniteHandler }, scopedSlots: t._u([{ key: 'error', fn: function(e) { var o = e.trigger; return n('div', {}, [t._v('\n          数据加载失败， '), n('button', { staticClass: 'btn btn-outline-theme btn-sm', on: { click: o }}, [t._v('重试')])]) } }]) }, [n('div', { staticClass: 'mb-3 fs-12 text-muted', attrs: { slot: 'no-more' }, slot: 'no-more' }, [t._v('全部数据已加载完毕……')]), t._v(' '), n('div', { staticClass: 'mt-10', class: t.comment.nocomment ? 'chat-hidden' : '', attrs: { slot: 'no-results' }, slot: 'no-results' }, [n('img', { staticClass: 'w-80 mb-4', attrs: { src: t.imgAssetsUrl('/assets/svg/comments.svg') }}), t._v(' '), n('h5', { staticClass: 'mb-6' }, [t._v('还没有评论哦!')])])]), t._v(' '), t._l(t.chatList, function(e, o) { return n('div', { key: o, staticClass: 'd-flex mb-3' }, [n('div', { staticClass: 'w-28 mr-3' }, [e.name === 'MacWk管理员' || e.name.search('HapiGo') !== -1 || e.name.search('恒星播放器') !== -1 || e.name.search('StellarPlayer') !== -1 || e.name.search('iShot') !== -1 || e.name.search('iRightMouse') !== -1 || e.name.search('FlyKey') !== -1 || e.name.search('MyZip Pro') !== -1 || e.name.search('FastZip') !== -1 || e.name.search('Better And Better') !== -1 || e.name.search('自动切换输入法') !== -1 || e.name.search('ToDesk') !== -1 || e.name.search('Effie') !== -1 || e.name.search('PD Runner') !== -1 || e.name.search('lihaoyun6') !== -1 || e.name.search('Bob') !== -1 || e.name.search('Picsee') !== -1 || e.name.search('chitaner') !== -1 || e.name.search('apifox') !== -1 || e.name.search('Apifox') !== -1 || e.name.search('草原企鵝') !== -1 || e.name.search('草原企鹅') !== -1 ? [e.name === 'MacWk管理员' ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/assets/images/logo.svg' }})] : t._e(), t._v(' '), e.name.search('HapiGo') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/hapigo-1.png' }})] : t._e(), t._v(' '), e.name.search('恒星播放器') !== -1 || e.name.search('StellarPlayer') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/stellarplayer.png' }})] : t._e(), t._v(' '), e.name.search('草原企鵝') !== -1 || e.name.search('草原企鹅') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/btwise-vip.qq.com.jpg' }})] : t._e(), t._v(' '), e.name.search('ToDesk') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/todesk.png' }})] : t._e(), t._v(' '), e.name.search('Effie') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/effie.png' }})] : t._e(), t._v(' '), e.name.search('PD Runner') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/pd-runner.png' }})] : t._e(), t._v(' '), e.name.search('lihaoyun6') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/pd-runner.png' }})] : t._e(), t._v(' '), e.name.search('iShot') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/better-365.png' }})] : t._e(), t._v(' '), e.name.search('iRightMouse') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/better-365.png' }})] : t._e(), t._v(' '), e.name.search('MyZip Pro') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/better-365.png' }})] : t._e(), t._v(' '), e.name.search('FastZip') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/better-365.png' }})] : t._e(), t._v(' '), e.name.search('FlyKey') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/better-365.png' }})] : t._e(), t._v(' '), e.name.search('Better And Better') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/better-365.png' }})] : t._e(), t._v(' '), e.name.search('自动切换输入法') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/better-365.png' }})] : t._e(), t._v(' '), e.name.search('Bob') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/bob-bs.png' }})] : t._e(), t._v(' '), e.name.search('Picsee') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/picsee.png' }})] : t._e(), t._v(' '), e.name.search('chitaner') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/picsee.png' }})] : t._e(), t._v(' '), e.name.search('apifox') !== -1 || e.name.search('Apifox') !== -1 ? [n('img', { staticClass: 'circle', attrs: { src: 'https://cdn.macwk.com/public/uploads/_/originals/apifox-1.png' }})] : t._e()] : [n('avataaars')]], 2), t._v(' '), n('section', { staticClass: 'flex-grow' }, [n('div', { staticClass: 'mb-1' }, [e.name === 'MacWk管理员' || e.name.search('HapiGo') !== -1 || e.name.search('恒星播放器') !== -1 || e.name.search('StellarPlayer') !== -1 || e.name.search('iShot') !== -1 || e.name.search('iRightMouse') !== -1 || e.name.search('FlyKey') !== -1 || e.name.search('MyZip Pro') !== -1 || e.name.search('FastZip') !== -1 || e.name.search('Better And Better') !== -1 || e.name.search('自动切换输入法') !== -1 || e.name.search('ToDesk') !== -1 || e.name.search('Effie') !== -1 || e.name.search('Bob') !== -1 || e.name.search('PD Runner') !== -1 || e.name.search('lihaoyun6') !== -1 || e.name.search('Picsee') !== -1 || e.name.search('chitaner') !== -1 || e.name.search('apifox') !== -1 || e.name.search('Apifox') !== -1 || e.name.search('草原企鵝') !== -1 || e.name.search('草原企鹅') !== -1 ? [e.name === 'MacWk管理员' ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('MacWk管理员')])] : t._e(), t._v(' '), e.name.search('ToDesk') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('ToDesk 官方')])] : t._e(), t._v(' '), e.name.search('Effie') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('Effie 官方')])] : t._e(), t._v(' '), e.name.search('HapiGo') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('HapiGo 官方')])] : t._e(), t._v(' '), e.name.search('恒星播放器') !== -1 || e.name.search('StellarPlayer') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('恒星播放器 - 官方')])] : t._e(), t._v(' '), e.name.search('iRightMouse') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('Better 365 官方')])] : t._e(), t._v(' '), e.name.search('MyZip Pro') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('Better 365 官方')])] : t._e(), t._v(' '), e.name.search('FastZip') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('Better 365 官方')])] : t._e(), t._v(' '), e.name.search('FlyKey') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('Better 365 官方')])] : t._e(), t._v(' '), e.name.search('Better And Better') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('Better 365 官方')])] : t._e(), t._v(' '), e.name.search('自动切换输入法') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('Better 365 官方')])] : t._e(), t._v(' '), e.name.search('iShot') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('Better 365 官方')])] : t._e(), t._v(' '), e.name.search('Bob') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('Bob 官方')])] : t._e(), t._v(' '), e.name.search('PD Runner') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('PD Runner 开发者')])] : t._e(), t._v(' '), e.name.search('lihaoyun6') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('PD Runner 开发者')])] : t._e(), t._v(' '), e.name.search('Picsee') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('Picsee 官方')])] : t._e(), t._v(' '), e.name.search('chitaner') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('Picsee 官方')])] : t._e(), t._v(' '), e.name.search('草原企鵝') !== -1 || e.name.search('草原企鹅') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('汉化作者 - ' + t._s(e.name))])] : t._e(), t._v(' '), e.name.search('apifox') !== -1 || e.name.search('Apifox') !== -1 ? [n('span', { staticClass: 'fs-12 fw-600 text-primary mr-1' }, [t._v('Apifox 官方')])] : t._e()] : [n('span', { staticClass: 'fs-12 mr-1 fw-600 text-darken' }, [t._v(t._s(e.name))])], t._v(' '), n('span', { staticClass: 'opacity-70 fs-12 text-muted pl-1' }, [n('span', [t._v(t._s(t._f('toDateTimeJ')(e.created_on)))])])], 2), t._v(' '), e.parent && e.parent.content ? n('div', { staticClass: 'ReplyMessageBody fs-12 mb-2' }, [e.parent && e.parent.content ? [n('span', { staticClass: 'text-muted' }, [t._v('回复')]), n('span', { staticClass: 'text-primary' }, [t._v(t._s(e.parent.name))]), n('span', { staticClass: 'text-muted' }, [t._v('的评论：')])] : t._e(), t._v(' '), n('span', { staticClass: 'text-muted' }, [t._v(t._s(e.parent.content))])], 2) : t._e(), t._v(' '), n('div', { staticClass: 'MessageBody mb-1' }, [e.name === 'MacWk管理员' || e.name.search('HapiGo') !== -1 || e.name.search('PD Runner') !== -1 || e.name.search('lihaoyun6') !== -1 || e.name.search('iRightMouse') !== -1 || e.name.search('Picsee') !== -1 || e.name.search('chitaner') !== -1 || e.name.search('iShot') !== -1 || e.name.search('ToDesk') !== -1 || e.name.search('Bob') !== -1 || e.name.search('apifox') !== -1 || e.name.search('Apifox') !== -1 || e.name.search('草原企鵝') !== -1 || e.name.search('草原企鹅') !== -1 ? [n('span', { domProps: { innerHTML: t._s(t.$options.filters.parseMd(e.content)) }})] : [t._v('\n              ' + t._s(e.content) + '\n            ')]], 2)])]) })], 2), t._v(' '), n('div', { staticClass: 'chat-footer' }, [n('div', [n('textarea', { directives: [{ name: 'model', rawName: 'v-model', value: t.comment.content, expression: 'comment.content' }], ref: 'chats', attrs: { rows: '2', placeholder: t.commentable ? '因厂商要求，此应用已禁止评论' : t.getCommentPlaceHolder(t.id), disabled: t.commentable }, domProps: { value: t.comment.content }, on: { input: function(e) { e.target.composing || t.$set(t.comment, 'content', e.target.value) } }})]), t._v(' '), n('div', { staticClass: 'd-flex align-items-center pl-3 clearfix' }, [n('a', { directives: [{ name: 'popover', rawName: 'v-popover:faceRight', arg: 'faceRight' }], staticClass: 'nav-link p-0 cursor-pointer' }, [n('i', { staticClass: 'icon-smile fs-18' })]), t._v(' '), n('el-popover', { ref: 'faceRight', attrs: { 'popper-class': 'emoji-popover', placement: 'left', trigger: 'click' }}, [n('VueEmoji', { on: { onSelected: t.onSelectedChat }})], 1), t._v(' '), n('a', { staticClass: 'fs-12 ml-5', staticStyle: { 'margin-top': '-2px' }, attrs: { href: '/privacy', target: '_blank' }}, [t._v('查看隐私政策')]), t._v(' '), n('div', { staticClass: 'comment-post flex-grow text-right' }, [n('span', [n('button', { staticClass: 'btn btn-theme btn-sm px-5 pt-1 fs-14', staticStyle: { 'border-top-left-radius': '10px' }, attrs: { disabled: t.comment.loading || t.commentable }, on: { click: function(e) { return t.addChat() } }}, [t._v('评论')])])])], 1)]), t._v(' '), n('van-dialog', { attrs: { showCancelButton: '', className: 'shadow-4 position-absolute', width: '360px', title: '输入昵称和邮箱' }, on: { confirm: function(e) { return t.addChatNameEmail() }, cancel: function(e) { t.chatNeedMail = !1 } }, model: { value: t.chatNeedMail, callback: function(e) { t.chatNeedMail = e }, expression: 'chatNeedMail' }}, [n('div', { staticClass: 'px-6 py-5' }, [n('p', [n('span', { staticClass: 'text-success' }, [t._v('推荐使用 QQ 邮箱')]), t._v('，有紧急的问题可以快速联系到您。')]), t._v(' '), n('div', { staticClass: 'form-group comment-form-group' }, [n('input', { directives: [{ name: 'model', rawName: 'v-model', value: t.comment.name, expression: 'comment.name' }], staticClass: 'form-control rounded', attrs: { type: 'text', placeholder: '您的昵称' }, domProps: { value: t.comment.name }, on: { input: function(e) { e.target.composing || t.$set(t.comment, 'name', e.target.value) } }})]), t._v(' '), n('div', { staticClass: 'form-group comment-form-group' }, [n('input', { directives: [{ name: 'model', rawName: 'v-model', value: t.comment.email, expression: 'comment.email' }], staticClass: 'form-control rounded', attrs: { type: 'email', placeholder: '您的邮箱' }, domProps: { value: t.comment.email }, on: { input: function(e) { e.target.composing || t.$set(t.comment, 'email', e.target.value) } }})])])])], 1) }, [], !1, null, null, null).exports; function T(object, t) { var e = Object.keys(object); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(object); t && (n = n.filter(function(t) { return Object.getOwnPropertyDescriptor(object, t).enumerable })), e.push.apply(e, n) } return e } function I(t) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; i % 2 ? T(Object(source), !0).forEach(function(e) { Object(o.a)(t, e, source[e]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(source)) : T(Object(source)).forEach(function(e) { Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(source, e)) }) } return t }e.a = I(I({}, S), {}, { install: function(t) { return t.component(S.name, S) } }) }, 691: function(t, e, n) { 'use strict'; var o = n(15); var r = n(224)(5); var c = 'find'; var l = !0; c in [] && Array(1).find(function() { l = !1 }), o(o.P + o.F * l, 'Array', { find: function(t) { return r(this, t, arguments.length > 1 ? arguments[1] : void 0) } }), n(223)(c) }, 692: function(t, e) { var n = 0.1; var o = typeof Float32Array === 'function'; function r(t, e) { return 1 - 3 * e + 3 * t } function c(t, e) { return 3 * e - 6 * t } function l(t) { return 3 * t } function m(t, e, n) { return ((r(e, n) * t + c(e, n)) * t + l(e)) * t } function d(t, e, n) { return 3 * r(e, n) * t * t + 2 * c(e, n) * t + l(e) } function h(t) { return t }t.exports = function(t, e, r, c) { if (!(t >= 0 && t <= 1 && r >= 0 && r <= 1)) throw new Error('bezier x values must be in [0, 1] range'); if (t === e && r === c) return h; for (var l = o ? new Float32Array(11) : new Array(11), i = 0; i < 11; ++i)l[i] = m(i * n, t, r); function f(e) { for (var o = 0, c = 1; c !== 10 && l[c] <= e; ++c)o += n; --c; var h = o + (e - l[c]) / (l[c + 1] - l[c]) * n; var f = d(h, t, r); return f >= 0.001 ? (function(t, e, n, o) { for (var i = 0; i < 4; ++i) { var r = d(e, n, o); if (r === 0) return e; e -= (m(e, n, o) - t) / r } return e }(e, h, t, r)) : f === 0 ? h : (function(t, e, n, o, r) { var c; var l; var i = 0; do { (c = m(l = e + (n - e) / 2, o, r) - t) > 0 ? n = l : e = l } while (Math.abs(c) > 1e-7 && ++i < 10);return l }(e, o, o + n, t, r)) } return function(t) { return t === 0 ? 0 : t === 1 ? 1 : m(f(t), e, c) } } }, 694: function(t, e, n) { 'use strict'; n(19), n(12), n(13), n(26), n(27); var o = n(3); var r = (n(11), n(157)); var c = (n(47), n(81), n(691), n(16), n(692)); var l = n.n(c); var m = { props: { activeClass: { type: String, default: 'active' }, offset: { type: Number, default: 80 }, scrollOffset: { type: Number, default: 50 }, scrollContainerSelector: { type: String, default: '' }, clickToScroll: { type: Boolean, default: !0 }, duration: { type: Number, default: 500 }, alwaysTrack: { type: Boolean, default: !1 }, bezierEasingValue: { type: String, default: '.5,0,.35,1' }, modifyUrl: { type: Boolean, default: !0 }, exact: { type: Boolean, default: !1 }, highlightFirstItem: { type: Boolean, default: !1 }, tag: { type: String, default: 'nav' }}, data: function() { return { observer: null, items: [], currentItem: null, lastActiveItem: null, scrollAnimationFrame: null, bezierEasing: l.a } }, computed: { cubicBezierArray: function() { return this.bezierEasingValue.split(',') }, scrollContainer: function() { var t = window; return this.scrollContainerSelector && (t = document.querySelector(this.scrollContainerSelector) || window), t } }, mounted: function() { var t = window.MutationObserver || window.WebKitMutationObserver; this.observer || (this.observer = new t(this.initScrollactiveItems), this.observer.observe(this.$refs['scrollactive-nav-wrapper'], { childList: !0, subtree: !0 })), this.initScrollactiveItems(), this.removeActiveClass(), this.currentItem = this.getItemInsideWindow(), this.currentItem && this.currentItem.classList.add(this.activeClass), this.scrollToHashElement(), this.scrollContainer.addEventListener('scroll', this.onScroll) }, updated: function() { this.initScrollactiveItems() }, beforeDestroy: function() { this.scrollContainer.removeEventListener('scroll', this.onScroll), window.cancelAnimationFrame(this.scrollAnimationFrame) }, methods: { onScroll: function(t) { this.currentItem = this.getItemInsideWindow(), this.currentItem !== this.lastActiveItem && (this.removeActiveClass(), this.$emit('itemchanged', t, this.currentItem, this.lastActiveItem), this.lastActiveItem = this.currentItem), this.currentItem && this.currentItem.classList.add(this.activeClass) }, getItemInsideWindow: function() { var t; var e = this; return [].forEach.call(this.items, function(n) { var o = n === e.items[0]; var r = document.getElementById(decodeURI(n.hash.substr(1))); if (r) { var c = e.scrollContainer.scrollTop || window.pageYOffset; var l = c >= e.getOffsetTop(r) - e.offset; var m = c < e.getOffsetTop(r) - e.offset + r.offsetHeight; o && e.highlightFirstItem && m && (t = n), e.exact && l && m && (t = n), !e.exact && l && (t = n) } }), t }, initScrollactiveItems: function() { var t = this; this.items = this.$el.querySelectorAll('.scrollactive-item'), this.clickToScroll ? [].forEach.call(this.items, function(e) { e.addEventListener('click', t.handleClick) }) : [].forEach.call(this.items, function(e) { e.removeEventListener('click', t.handleClick) }) }, setScrollactiveItems: function() { this.initScrollactiveItems() }, handleClick: function(t) { var e = this; t.preventDefault(); var n = t.currentTarget.hash; var o = document.getElementById(decodeURI(n.substr(1))); o ? (this.alwaysTrack || (this.scrollContainer.removeEventListener('scroll', this.onScroll), window.cancelAnimationFrame(this.scrollAnimationFrame), this.removeActiveClass(), t.currentTarget.classList.add(this.activeClass)), this.scrollTo(o).then(function() { if (!e.alwaysTrack) { e.scrollContainer.addEventListener('scroll', e.onScroll); e.currentItem = [].find.call(e.items, function(t) { return decodeURI(t.hash.substr(1)) === o.id }), e.currentItem !== e.lastActiveItem && (e.$emit('itemchanged', null, e.currentItem, e.lastActiveItem), e.lastActiveItem = e.currentItem) }e.modifyUrl && e.pushHashToUrl(n) })) : console.warn("[vue-scrollactive] Element '".concat(n, "' was not found. Make sure it is set in the DOM.")) }, scrollTo: function(t) { var e = this; return new Promise(function(n) { var o = e.getOffsetTop(t); var c = e.scrollContainer.scrollTop || window.pageYOffset; var l = o - c; var m = e.bezierEasing.apply(e, Object(r.a)(e.cubicBezierArray)); var d = null; window.requestAnimationFrame(function t(o) { d || (d = o); var progress = o - d; var r = progress / e.duration; progress >= e.duration && (progress = e.duration), r >= 1 && (r = 1); var h = e.scrollOffset || e.offset; var f = c + m(r) * (l - h); e.scrollContainer.scrollTo(0, f), progress < e.duration ? e.scrollAnimationFrame = window.requestAnimationFrame(t) : n() }) }) }, getOffsetTop: function(element) { for (var t = 0, e = element; e;)t += e.offsetTop, e = e.offsetParent; return this.scrollContainer.offsetTop && (t -= this.scrollContainer.offsetTop), t }, removeActiveClass: function() { var t = this; [].forEach.call(this.items, function(e) { e.classList.remove(t.activeClass) }) }, scrollToHashElement: function() { var t = this; var e = window.location.hash; if (e) { var n = document.querySelector(decodeURI(e)); n && (window.location.hash = '', setTimeout(function() { var o = n.offsetTop - t.offset; t.scrollContainer.scrollTo(0, o), t.pushHashToUrl(e) }, 0)) } }, pushHashToUrl: function(t) { window.history.pushState ? window.history.pushState(null, null, t) : window.location.hash = t } }}; var d = n(6); var h = Object(d.a)(m, function() { var t = this; var e = t.$createElement; return (t._self._c || e)(t.tag, { ref: 'scrollactive-nav-wrapper', tag: 'component', staticClass: 'scrollactive-nav' }, [t._t('default')], 2) }, [], !1, null, null, null).exports; function f(object, t) { var e = Object.keys(object); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(object); t && (n = n.filter(function(t) { return Object.getOwnPropertyDescriptor(object, t).enumerable })), e.push.apply(e, n) } return e } function v(t) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; i % 2 ? f(Object(source), !0).forEach(function(e) { Object(o.a)(t, e, source[e]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(source)) : f(Object(source)).forEach(function(e) { Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(source, e)) }) } return t }e.a = v(v({}, h), {}, { install: function(t) { return t.component(h.name, h) } }) }, 754: function(t, e, n) { 'use strict'; n.r(e); var o = n(9); var r = (n(55), n(13), n(54), n(683)); var c = n(694); var l = { head: function() { if (this.post) return { title: this.post.title, meta: [{ hid: 'description', name: 'description', content: this.post.description }, { hid: 'keywords', name: 'keywords', content: this.post.tags.join(',') }], link: this.getLinkRel() } }, data: function() { return { chatOpenClass: '', post: {}, likeclass: '', tocTagsList: [], backPrevScrollClass: 'back-prev article-back-prev', showIcon: !1, scrollTop: 0, defaultType: 0, defaultTop: 400, defaultRight: 30, defaultBottom: 95, defaultDuration: 300 } }, components: { commentChat: r.a, ScrollActive: c.a }, computed: { chatShow: { get: function() { return this.$storage.syncUniversal('chatShow') }, set: function(t) { return t } }}, asyncData: function(t) { return Object(o.a)(regeneratorRuntime.mark(function e() { var n, o, r, c, data; return regeneratorRuntime.wrap(function(e) { for (;;) switch (e.prev = e.next) { case 0:if (n = t.app, o = t.params, r = t.error, !(c = t.payload)) { e.next = 5; break } return e.abrupt('return', { post: c }); case 5:return e.next = 7, n.context.app.$client.getItems('article', { fields: 'id,photo.filename_disk.*,modified_on,slug,tags,title,description,category.*,content,comment_total', filter: { slug: { eq: o.slug }}}); case 7:if ((data = e.sent).data[0]) { e.next = 10; break } return e.abrupt('return', r({ message: '404 Page not found', statusCode: 404 })); case 10:return e.abrupt('return', { post: data.data[0] }); case 11:case 'end':return e.stop() } }, e) }))() }, methods: { goTop: function() { var t = function t() { n.scrollTop >= 0 ? (n.scrollTop -= e, document.documentElement.scrollTop = document.body.scrollTop = n.scrollTop, t.rafTimer = requestAnimationFrame(t)) : (document.body.scrollTop = 0, cancelAnimationFrame(t.rafTimer)) }; window.requestAnimationFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function(t) { window.setTimeout(t, 1e3 / 60) }; var e = this.scrollTop / (this.defaultDuration / (1e3 / 60)) >> 0; var n = this; t.rafTimer = requestAnimationFrame(t) }, handleScroll: function() { this.scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop, this.scrollTop > this.defaultTop ? this.showIcon = !0 : this.showIcon = !1, (window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop) > 400 ? (this.fiexdDownloadbarScrollClass = 'is-scroll macwk-animation slideUpReturn', this.backPrevScrollClass = 'back-prev article-back-prev scroll-back-prev macwk-animation slideUpReturn') : (this.fiexdDownloadbarScrollClass = '', this.backPrevScrollClass = 'back-prev article-back-prev') }, changeChatState: function(t) { t === 'open' ? (this.chatOpenClass = 'tinDownOut', this.$storage.setUniversal('chatShow', !0)) : (this.chatOpenClass = 'tinRightIn', this.$storage.setUniversal('chatShow', !1)) }, generateToc: function(body) { return body.filter(function(t) { return t.type === 'H2' || t.type === 'H3' }).map(function(t) { return { id: t.attributes.id, depth: { H2: 1, H3: 2 }[t.type], text: t.content[0] } }) }, mapDOM: function(element, t) { var e; var n = {}; return typeof element === 'string' && (window.DOMParser ? e = (new DOMParser()).parseFromString(element, 'text/xml') : ((e = new ActiveXObject('Microsoft.XMLDOM')).async = !1, e.loadXML(element)), element = e.firstChild), (function t(element, object) { object.type = element.nodeName; var e = element.childNodes; if (e != null && e.length) { object.content = []; for (var i = 0; i < e.length; i++)e[i].nodeType === 3 ? object.content.push(e[i].nodeValue) : (object.content.push({}), t(e[i], object.content[object.content.length - 1])) } if (element.attributes != null && element.attributes.length) { object.attributes = {}; for (i = 0; i < element.attributes.length; i++)object.attributes[element.attributes[i].nodeName] = element.attributes[i].nodeValue } }(element, n)), t ? JSON.parse(JSON.stringify(n)).content[0].content : n } }, beforeDestroy: function() { window.removeEventListener('scroll', this.handelScroll, !1) }, mounted: function() { var t = this; setTimeout(function() { window.addEventListener('scroll', t.handleScroll); var e = document.getElementsByClassName('content-markdown')[0]; var body = t.mapDOM(e, !0); t.tocTagsList = t.generateToc(body) }, 500), this.top && (this.defaultTop = this.top), this.right && (this.defaultRight = this.right), this.bottom && (this.defaultBottom = this.bottom), this.duration && (this.defaultDuration = this.duration), window.addEventListener('scroll', this.handelScroll, !1) } }; var m = n(6); var component = Object(m.a)(l, function() { var t = this; var e = t.$createElement; var n = t._self._c || e; return n('div', { staticClass: 'overflow-hidden' }, [t.$device.isDesktop ? [n('div', { staticClass: 'article-details white bg layout-min-full-height' }, [n('div', { staticClass: 'py-6' }, [n('div', { staticClass: 'article-details-fg' }, [t.post.photo && t.post.photo.filename_disk ? n('div', { staticClass: 'article-banner' }, [n('div', { staticClass: 'imgBox' }, [n('img', { directives: [{ name: 'lazy', rawName: 'v-lazy', value: t.imgUrl(t.post.photo.filename_disk), expression: 'imgUrl(post.photo.filename_disk)' }], attrs: { alt: '' }})])]) : t._e(), t._v(' '), n('div', { staticClass: 'article-content py-7 px-10' }, [n('h1', { staticClass: 'b-0 mt-0 pb-0 mb-15', attrs: { id: 'article-top' }}, [t._v(t._s(t.post.title))]), t._v(' '), n('div', { staticClass: 'd-flex mb-6 align-items-center' }, [n('img', { directives: [{ name: 'lazy', rawName: 'v-lazy', value: t.imgUrl('g9sqh9gp.jpeg'), expression: "imgUrl('g9sqh9gp.jpeg')" }], staticClass: 'w-50 mw-50 h-50 b-0 circle m-0 mr-4' }), t._v(' '), n('div', { staticClass: 'flex' }, [n('h4', { staticClass: 'mb-0 mt-0' }, [t._v('Pertim')]), t._v(' '), n('p', { staticClass: 'mb-0 py-0 fs-14' }, [t._v(t._s(t._f('toDate')(t.post.modified_on)))])])]), t._v(' '), n('blockquote', { staticClass: 'blockquote' }, [n('div', { staticClass: 'text-muted', domProps: { textContent: t._s(t.post.description) }})]), t._v(' '), t.post.content ? n('div', { staticClass: 'content-markdown' }, [n('div', { staticClass: 'markdown line-numbers', domProps: { innerHTML: t._s(t.$options.filters.parseMd(t.post.content)) }})]) : t._e()])])]), t._v(' '), n('client-only', [n('div', { class: t.post.photo && t.post.photo.filename_disk ? t.backPrevScrollClass : 'back-prev article-back-prev top-200' }, [t.tocTagsList.length ? n('div', { staticClass: 'w-180' }, [n('a', { on: { click: function(e) { return t.goTop() } }}, [n('h6', { staticClass: 'fs-14 fw-600' }, [t._v('导航 '), n('i', { staticClass: 'icon-arrow-right1 v-m-2', staticStyle: { transform: 'rotate(-90deg)' }})])]), t._v(' '), n('hr', { staticClass: 'my-2 w-50 ml-0' }), t._v(' '), n('ScrollActive', { staticClass: 'nav d-block' }, t._l(t.tocTagsList, function(e, o) { var r, c; return n('li', { key: o }, [n('a', { directives: [{ name: 'line-clamp', rawName: 'v-line-clamp:20', value: 1, expression: '1', arg: '20' }], staticClass: 'scrollactive-item nav-link py-1 fs-13', class: [(r = {}, r['pl-0'] = e.depth === 1, r), (c = {}, c['pl-2'] = e.depth === 2, c)], attrs: { href: '#' + e.id }}, [t._v(t._s(e.text))])]) }), 0)], 1) : t._e()])]), t._v(' '), t.chatShow ? t._e() : n('section', { staticClass: 'fiexd-comments-bar d-flex align-items-center is-scroll macwk-animation slow', class: t.chatOpenClass }, [n('div', { staticClass: 'cursor-pointer w-full', on: { click: function(e) { return t.changeChatState('open') } }}, [n('div', { staticClass: 'fs-24 text-center' }, [t._v('共 ' + t._s(t.post.comment_total ? t.post.comment_total : 0) + ' 条评论')])])]), t._v(' '), n('van-popup', { staticClass: 'chat-container overflow-hidden', attrs: { round: '', overlay: !1, 'lock-scroll': !1, position: 'bottom' }, model: { value: t.chatShow, callback: function(e) { t.chatShow = e }, expression: 'chatShow' }}, [n('div', { staticClass: 'chat-header position-relative' }, [t._v('\n          评论列表\n          '), n('i', { staticClass: 'icon-close cursor-pointer', on: { click: function(e) { return t.changeChatState('close') } }})]), t._v(' '), n('commentChat', { attrs: { id: t.post.id, type: 'article' }})], 1)], 1)] : [t.post.photo && t.post.photo.filename_disk ? n('div', { staticClass: 'imgBox mb-4' }, [n('img', { directives: [{ name: 'lazy', rawName: 'v-lazy', value: t.imgUrl(t.post.photo.filename_disk), expression: 'imgUrl(post.photo.filename_disk)' }], attrs: { alt: '' }})]) : t._e(), t._v(' '), n('div', { staticClass: 'p-5' }, [n('h3', [t._v(t._s(t.post.title))]), t._v(' '), n('p', { staticClass: 'text-muted' }, [t._v(t._s(t._f('toDate')(t.post.modified_on)))]), t._v(' '), n('blockquote', { staticClass: 'blockquote' }, [n('div', { staticClass: 'text-muted', domProps: { textContent: t._s(t.post.description) }})]), t._v(' '), n('div', { staticClass: 'article-content' }, [t.post.content ? n('div', { staticClass: 'content-markdown', attrs: { id: 'write' }}, [n('div', { staticClass: 'markdown line-numbers', domProps: { innerHTML: t._s(t.$options.filters.parseMd(t.post.content)) }})]) : t._e()])])]], 2) }, [], !1, null, null, null); e.default = component.exports } }])
